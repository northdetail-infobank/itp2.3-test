<html>
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
    <title>index</title>
  </head>
  <body>
    <h1>ITP 2.2, 2.3 検証</h1>
    <ul>
      <li>ポップアップブロックが効いているとうまく開かないので、適宜ブロックを無効化してください。途中でブロックされたらブロックを解除し、このページをリロードして最初からやりなおしてください</li>
      <li>キャッシュが残っているとsiteA, page4のreferrer省略のテストが失敗することがあるため、「開発＞キャッシュを空にする」を毎回実行してください</li>
      <li>cookieの寿命をjavascriptから確認する方法がないので、適宜開発ツールからcookieのExpiresを確認してください（つまり目視確認が必要です）</li>
      <li>ページのリロードによってアクセスの状態が変化するため、一連の流れとして実行してください</li>
    </ul>
    <p>startを押すと子ウィンドウが開いてcookieの設定や遷移を実行します。</p>
    <ul>
      <li><button type="button" onclick="start(event, 1)">start</button> 1. 初期設定(siteA, page1)</li>
      <li><button type="button" onclick="start(event, 2)">start</button> 2. リンク装飾付き遷移(siteB, page1 => siteA, page2 => siteA, page3)</li>
      <li><button type="button" onclick="start(event, 3)">start</button> 3. リンク装飾なし、referrer装飾あり遷移(siteB, page2 => siteB, page3 => siteA, page4)</li>
      <li><button type="button" onclick="start(event, 4)">start</button> 4. リンク装飾あり手動遷移(siteB, page4 => siteA, page5)</li>
    </ul>

    <script type="text/javascript">

      function start(evt, num) {
        evt.target.disabled = true

        if (num === 1) {
          const w = window.open('http://1stparty.localdomain/siteA.page1.html')
        }
        if (num === 2) {
          const w = window.open('http://3rdpartytestwebkit.org/siteB.page1.html')
        }
        if (num === 3) {
          const w = window.open('http://3rdpartytestwebkit.org/siteB.page2.html')
        }
        if (num === 4) {
          const w = window.open('http://3rdpartytestwebkit.org/siteB.page4.html')
        }
      }
    </script>

  </body>
</html>